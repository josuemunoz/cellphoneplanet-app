<!DOCTYPE html> 
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title></title>


<link href="http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.css" rel="stylesheet" type="text/css"/>
<link href="http://m.josue45.com/mobile/mobileTest/css.css" rel="stylesheet" type="text/css"/>

<!--
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->

<script src="http://code.jquery.com/jquery-1.6.4.min.js" type="text/javascript"></script>
<script src="http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.js" type="text/javascript"></script>


</head> 
<body> 
<div data-role="page" id="page">
	
		<!--
        <div data-role="header">
        <h1>hi</h1>
        </div>
        -->
        <div class="a">
        <div id="logoPlaceHolder"></div>
        </div>
        
	
	<div data-role="content">
    	<div id="testResults"></div>
    	<div id="test"></div>
    	<div id="smallImage"></div>
		<ul data-role="listview" data-inset="true" id="mainmenu">
        <li><a href="#page4" onClick="getProducts()">Products</a></li>
        
        <!--
			
            <li><a href="#page3">Page Three</a></li>
			<li><a href="#page4">Page Four</a></li>
		-->
        </ul>		
	</div>
    
    
    <!-- fix this please
    <div id="more" class="more"><img src="assets/more.png" width="95" height="65"></div>
	-->
    <div data-role="footer" id="m" class="c" style="">
    
		
    <h4>Page Footer</h4>
    <div id="phoneStuff">
    	
    	<a class="t2m-boton" id="login" onClick="logMeIn(); return FALSE"><span></span><span id="xyzz">LOG IN</span></a>
        <a class="t2m-boton" id="call"><span></span><span id="xyz">CALL</span></a>
        <a class="t2m-boton" id="text"><span></span><span id="xyzz">TEXT</span></a>
        <a class="t2m-boton" id="camera" onClick="capturePhoto(); return FALSE"><span></span><span id="xyzz">PICTURE</span></a>
        
    </div>
    
	</div>
     
</div>

<div data-role="page" id="page2">
	<div data-role="header">
		<h1 id="titleBaby">Page Two</h1>
	</div>
	<div data-role="content">	
		<div class="b"></div>
	</div>
    
	<div data-role="footer">
		<h4>Page Footer</h4>
	</div>
</div>

<div data-role="page" id="page3">
	<div data-role="header">
		<h1 id="titleBaby">Page Two</h1>
	</div>
	<div data-role="content">	
		<div class="b" id="mainPage2"></div>		
	</div>
	<div data-role="footer">
		<h4>Page Footer</h4>
	</div>
</div>

<div data-role="page" id="page4">
	<div data-role="header" data-add-back-btn="true">
		<h1>Page Four</h1>
	</div>
	<div data-role="content">	
		<ul id="productsMenu" data-role="listview" data-inset="true"></ul>	
	</div>
	<div data-role="footer">
		<h4>Page Footer</h4>
	</div>
</div>

<div data-role="page" id="page5">
	<div data-role="header">
		<h1>Page Four</h1>
	</div>
	<div data-role="content">	
		<div class="b">
        	<div id="displayProducts"></div>
        </div>
	</div>
	<div data-role="footer">
		<h4>Page Footer</h4>
	</div>
</div>


</body>
</html>

<script type="text/javascript">


	var id = 9;
	$(document).ready(function() {


	
	<!-- ------------------------------------------------------------------------------------------------>
	
	var doc_css = document.createElement("link");
	doc_css.setAttribute("type", "text/css");
	doc_css.setAttribute("rel", "stylesheet");
	doc_css.setAttribute("href", "http://m.josue45.com/mobile/final-customcss.php?iduser="+id);
	document.getElementsByTagName('head')[0].appendChild(doc_css);
	
	
	//API -> this is where pages come from 
	//http://m.josue45.com/mobile/listofpages.php?iduser=9
	function setSomeScripts(){
		
	var doc_pages = document.createElement("script");
	doc_pages.src = "http://m.josue45.com/mobile/listofpages.php?iduser="+id+"&callback=listofpages";
	document.getElementsByTagName('head')[0].appendChild(doc_pages);
	
	//get the logo and background image for mobile site and app
	var doc = document.createElement("script");
	doc.src = "http://m.josue45.com/mobile/logoandbackground.php?iduser="+id+"&callback=logoandbackground";
	document.getElementsByTagName('head')[0].appendChild(doc);
	
	//css. Gets the css for mobile or app
	
	
	}
	
	<!-- ------------------------------------------------------------------------------------------------>
	
	var businessName = "fixxxx"; //name of business
	//var who = "calmexmusicgrouptv1"; //youtube feed name
	var appInfo = " | App by josue45.com";
	var d = new Date();
	var year = d.getFullYear();
	 
	$("h1").empty().append(businessName);
	$("h4").empty().append(name+" "+year+" "+appInfo);
	$("title").empty().append(businessName+" App");		
	
	
	
	<!-- ********************************************************************************************************* -->
	//execute the functions please
	//very important
	setSomeScripts();
	
	<!-- ********************************************************************************************************* -->

    });
	
		function logMeIn(){
				var username = prompt("Enter Username:", "username");
				var password = prompt("Enter Password:", "password");
				
				if(username != "username" && password != "password"){
					if(username != null && password != null){
						//alert("welcome "+ username);
						
							$.post("http://cellphoneplanet.ca/api/index.php", {"user": username, "pass": password, "table": "Users", "logMeIn": "yes"}, function(data){
								if(data){
										alert("Welcome " + data[0].FullName);
									}else{
										alert("Info provided is incorrect!");
										}
								});
							//.done()
						}
					}else{
							alert("Please provide the right information");
							}
			}
		
		
		//sets logo and background
		function logoandbackground(logoandbackground){
			
			// Will set the classes for the icons
					$("#login >span").first().addClass('t2m-login-'+logoandbackground.iconClass);
					$("#call >span").first().addClass('t2m-phone-'+logoandbackground.iconClass);
					$("#text >span").first().addClass('t2m-sms-'+logoandbackground.iconClass);
					$("#camera >span").first().addClass('t2m-camera-'+logoandbackground.iconClass);
			
				var logo = document.createElement("img");
					logo.setAttribute("id", "logo");
					logo.setAttribute("src", logoandbackground.logo);
					console.log("logo created");
					$("#logoPlaceHolder").append(logo);
					
					//$("span").addClass(logoandbackground.iconClass);
					console.log($("span").attr("class"));
					
					
		}
		
		function getProducts(){
			var a ="";
			var li = "";
			//http://cellphoneplanet.ca/api/index.php?table=gallery
			$("#productsMenu").empty();
			$.getJSON("http://cellphoneplanet.ca/api/index.php?table=gallery&key=9", function(dataP){
					console.log("running getJSON:");
					for(var i=0; i<dataP.length; i++){
						a = document.createElement("a");
						
						li = document.createElement("li");
						a.setAttribute("id", dataP[i].id);
						a.setAttribute("name", i);
						a.setAttribute("href", "#page5");
						if(dataP[i].item_name != null){
						a.innerHTML = dataP[i].item_name;
						a.onclick = function test(){
								console.log("function test running baby");
								console.log(this.id);
								console.log(this.name);
								var img = document.createElement("img");
									img.setAttribute("src", "http://cellphoneplanet.ca/images_cell_phones/thumb_"+dataP[this.name].image_filename);
									$("#displayProducts").empty();
									$("#displayProducts").append("<h1>"+dataP[this.name].item_name+"</h1>");
									$("#displayProducts").append(img);
									$("#displayProducts").append("<h5>"+dataP[this.name].Description+"</h5>");
									$("#displayProducts").append("<h5>"+dataP[this.name].brand+" "+ dataP[this.name].model+"</h5>");
									//alert(data);
			};

						
						// function that pulls info from json file baby
						li.appendChild(a);
						$("#productsMenu").append(li);
						}
						}
							
						$("#productsMenu").listview("refresh");
					});
			}
			/*
		function test(){
			console.log("function test running");
			console.log(this.id);
			console.log(this.name);
			var img = document.createElement("img");
				img.setAttribute("src", "http://cellphoneplanet.ca/images_cell_phones/thumb_"+this.name);
				$("#displayProducts").append(img);
			}
		*/
		function BusinessInfo(BusinessInfo){
			
		}
		
		//sets list pages
		function listofpages(listofpages){
				var a = '';
				var li = '';
				for(var i=0; i<listofpages.length; i++){
					console.log(listofpages[i].id);
					
						li = document.createElement("li");
						//li.setAttribute("id", i);
						//li.setAttribute("title", listofpages[i].name);
						a  = document.createElement("a");
						a.setAttribute("id", listofpages[i].id);
						a.setAttribute("title", listofpages[i].name)
						a.setAttribute("href", "#page3");
						a.innerHTML = listofpages[i].name;
						li.appendChild(a);
						$("#mainmenu").append(li);
						
						a.onclick = function r(){
								if($(this).attr("id")){
									//alert($(this).id)
								id = $(this).attr("id");
								console.log($(this).text());
								console.log($(this).attr("id"));
								$("h1").empty().append($(this).text());
								$.ajax({
									url: "http://m.josue45.com/class/JosueMunoz.php?getInfo="+$(this).attr("id")+"&type=ready",
									})
									.done( function (page){
									$("#mainPage2").empty().append(page);
										})
									}else{
										$("h1").empty().append($(this).text());
										}//if statement end
							};
						
						
		 			
						
					}
				$("#mainmenu").listview("refresh");
				
				/*
								$("a").click( function(){
								if($(this).attr("id")){
									//alert($(this).id)
								id = $(this).attr("id");
								console.log($(this).text());
								console.log($(this).attr("id"));
								$("h1").empty().append($(this).text());
								$.ajax({
									url: "http://m.josue45.com/class/JosueMunoz.php?getInfo="+$(this).attr("id")+"&type=ready",
									})
									.done( function (page){
									$(".b").empty().append(page);
										})
									}else{
										$("h1").empty().append($(this).text());
										}//if statement end
							});
				*/
		}
		

</script>


<script>
   
   // JavaScript Document


document.addEventListener("deviceready",onDeviceReady,false);
	
	
    var pictureSource;   // picture source
    var destinationType; // sets the format of returned value 



        function win(r) {
           $("#testResults").append("Code = " + r.responseCode);
           $("#testResults").append("Response = " + r.response);
           $("#testResults").append("Sent = " + r.bytesSent);
        }

        function fail(error) {
            $("#testResults").append("An error has occurred: Code = " + error.code);
            $("#testResults").append("upload error source " + error.source);
            $("#testResults").append("upload error target " + error.target);
			/*
			this.imageURI = imageURI;
										this.imageData = imageData;
										this.FILE_URI = FILE_URI;
										this.DATA_URL = DATA_URL;
        */
		
		}
    // Wait for Cordova to connect with the device
    //


    // Cordova is ready to be used!
    //
	
function onDeviceReady() {
		
		
        pictureSource=navigator.camera.PictureSourceType;
        destinationType=navigator.camera.DestinationType;
		console.warn("ready to go");
		document.addEventListener("menubutton", hi, false);

    }

   

function hi(){
		
				$(".c").slideToggle('slow');
			
			
			
		
		}
   
   function capturePhoto() {
	   
	   $("#testResults").append("<br/>capturePhoto() running");
		// Take picture using device camera and retrieve image as base64-encoded string
		  navigator.camera.getPicture(uploadPhoto, onFail, { quality: 100,targetWidth: 700,
				targetHeight:600,
			
				destinationType: navigator.camera.DestinationType.FILE_URI,
				sourceType: navigator.camera.PictureSourceType.DATA_URL
				});
											
			//this.x = imageURI;
				//alert(x);
											
		}
	function onFail(message){
     alert('Failed because: ' + message);
	 $("#testResults").append("<br/>onFail() running");
    }

	function uploadPhoto(imageURI){
		 $("#testResults").append("<br/>uploadPhote() running");
			var options = new FileUploadOptions();
				options.fileKey="file";
				options.fileName=imageURI.substr(imageURI.lastIndexOf('/')+1)+'.jpg';
				options.mimeType="image/jpeg";
				options.chunkedMode = false;
				var ft = new FileTransfer();
				//var c = localStorage.getItem('userId');
				var c = 256;

				ft.upload(imageURI, "http://www.salecarro.com/uploadTest/test_upload.php?user="+c, win, fail, options, true);
				onPhotoDataSuccess(imageURI);				
        }
		
	function onPhotoDataSuccess(FILE_URI) { // Called when a photo is successfully retrieved
    // Uncomment to view the base64 encoded image data
      // console.log(imageData);
	  //this.imageURI = imageURI;
		//this.imageData = imageData;
		//this.FILE_URI = FILE_URI;
	
	 
	  $("#testResults").append("<br/>Picture created succefully.");
	//var E = document.getElementById('error');
		
      // Get image handle
      //
	  //show('test');
      var smallImage = document.getElementById('smallImage');

      smallImage.style.display = 'block';

      smallImage.src = FILE_URI;
	
	  imageLoaded();
	 									
    
	}
	
	function imageLoaded()//image loaded will display after image loaded
	{
		$("#testResults").append("<br/>imageLoaded() running");
		var x = document.getElementById('test');
		var text = document.createTextNode('Image Uploaded :)');
		var green = document.createElement('div');
			
			x.appendChild(green);
			green.appendChild(text);
			green.setAttribute('class', 'green');
			//show('test')
			//clearAll();//line 500
			//setTimeout("animateThis()",5000);
		}	
   
  
</script>
<script src="cordova.js"></script>